<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# smartmontools

```go
import "github.com/dianlight/smartmontools-go"
```

Package smartmontools provides Go bindings for interfacing with smartmontools to monitor and manage storage device health using S.M.A.R.T. data.

The library wraps the smartctl command\-line utility and provides a clean, idiomatic Go API for accessing SMART information from storage devices.

### Features

- Device scanning and discovery
- SMART health status checking
- Detailed SMART attribute reading
- Temperature monitoring
- Power\-on time tracking
- Self\-test execution and progress monitoring
- Device information retrieval
- SMART support detection and management
- Self\-test availability checking

### Prerequisites

This library requires smartctl \(part of smartmontools\) to be installed:

Linux:

```
sudo apt-get install smartmontools  # Debian/Ubuntu
sudo yum install smartmontools       # RHEL/CentOS/Fedora
sudo pacman -S smartmontools         # Arch Linux
```

macOS:

```
brew install smartmontools
```

Windows:

```
Download from https://www.smartmontools.org/
```

### Basic Usage

```
package main

import (
    "fmt"
    "log"

    "github.com/dianlight/smartmontools-go"
)

func main() {
    // Create a new client
    client, err := smartmontools.NewClient()
    if err != nil {
        log.Fatal(err)
    }

    // Scan for devices
    devices, err := client.ScanDevices()
    if err != nil {
        log.Fatal(err)
    }

    // Check health of first device
    if len(devices) > 0 {
        healthy, _ := client.CheckHealth(devices[0].Name)
        if healthy {
            fmt.Println("Device is healthy")
        }
    }
}
```

### Permissions

Many operations require elevated privileges \(root/administrator\) to access disk devices. The library will return errors if permissions are insufficient.

### Thread Safety

The Client type is safe for concurrent use by multiple goroutines.

Package smartmontools provides Go bindings for interfacing with smartmontools to monitor and manage storage device health using S.M.A.R.T. data.

The library wraps the smartctl command\-line utility and provides a clean, idiomatic Go API for accessing SMART information from storage devices.

## Index

- [type AtaSmartData](<#AtaSmartData>)
- [type Capabilities](<#Capabilities>)
- [type CapabilitiesOutput](<#CapabilitiesOutput>)
- [type Client](<#Client>)
  - [func \(c \*Client\) AbortSelfTest\(devicePath string\) error](<#Client.AbortSelfTest>)
  - [func \(c \*Client\) CheckHealth\(devicePath string\) \(bool, error\)](<#Client.CheckHealth>)
  - [func \(c \*Client\) DisableSMART\(devicePath string\) error](<#Client.DisableSMART>)
  - [func \(c \*Client\) EnableSMART\(devicePath string\) error](<#Client.EnableSMART>)
  - [func \(c \*Client\) GetAvailableSelfTests\(devicePath string\) \(\*SelfTestInfo, error\)](<#Client.GetAvailableSelfTests>)
  - [func \(c \*Client\) GetDeviceInfo\(devicePath string\) \(map\[string\]interface\{\}, error\)](<#Client.GetDeviceInfo>)
  - [func \(c \*Client\) GetSMARTInfo\(devicePath string\) \(\*SMARTInfo, error\)](<#Client.GetSMARTInfo>)
  - [func \(c \*Client\) IsSMARTSupported\(devicePath string\) \(\*SMARTSupportInfo, error\)](<#Client.IsSMARTSupported>)
  - [func \(c \*Client\) RunSelfTest\(devicePath string, testType string\) error](<#Client.RunSelfTest>)
  - [func \(c \*Client\) RunSelfTestWithProgress\(ctx context.Context, devicePath string, testType string, callback ProgressCallback\) error](<#Client.RunSelfTestWithProgress>)
  - [func \(c \*Client\) ScanDevices\(\) \(\[\]Device, error\)](<#Client.ScanDevices>)
- [type Cmd](<#Cmd>)
- [type Commander](<#Commander>)
- [type Device](<#Device>)
- [type Flags](<#Flags>)
- [type Message](<#Message>)
- [type NvmeControllerCapabilities](<#NvmeControllerCapabilities>)
- [type NvmeOptionalAdminCommands](<#NvmeOptionalAdminCommands>)
- [type NvmeSmartHealth](<#NvmeSmartHealth>)
- [type OfflineDataCollection](<#OfflineDataCollection>)
- [type PollingMinutes](<#PollingMinutes>)
- [type PowerOnTime](<#PowerOnTime>)
- [type ProgressCallback](<#ProgressCallback>)
- [type Raw](<#Raw>)
- [type SMARTInfo](<#SMARTInfo>)
- [type SMARTSupportInfo](<#SMARTSupportInfo>)
- [type SelfTest](<#SelfTest>)
- [type SelfTestInfo](<#SelfTestInfo>)
- [type SmartAttribute](<#SmartAttribute>)
- [type SmartClient](<#SmartClient>)
  - [func NewClient\(\) \(SmartClient, error\)](<#NewClient>)
  - [func NewClientWithCommander\(smartctlPath string, commander Commander\) SmartClient](<#NewClientWithCommander>)
  - [func NewClientWithPath\(smartctlPath string\) SmartClient](<#NewClientWithPath>)
- [type SmartStatus](<#SmartStatus>)
- [type SmartSupport](<#SmartSupport>)
- [type SmartctlInfo](<#SmartctlInfo>)
- [type Temperature](<#Temperature>)


<a name="AtaSmartData"></a>
## type [AtaSmartData](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L107-L112>)

AtaSmartData represents ATA SMART attributes

```go
type AtaSmartData struct {
    OfflineDataCollection *OfflineDataCollection `json:"offline_data_collection,omitempty"`
    SelfTest              *SelfTest              `json:"self_test,omitempty"`
    Capabilities          *Capabilities          `json:"capabilities,omitempty"`
    Table                 []SmartAttribute       `json:"table,omitempty"`
}
```

<a name="Capabilities"></a>
## type [Capabilities](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L134-L139>)

Capabilities represents SMART capabilities

```go
type Capabilities struct {
    Values                      []int `json:"values,omitempty"`
    ExecOfflineImmediate        bool  `json:"exec_offline_immediate_supported,omitempty"`
    SelfTestsSupported          bool  `json:"self_tests_supported,omitempty"`
    ConveyanceSelfTestSupported bool  `json:"conveyance_self_test_supported,omitempty"`
}
```

<a name="CapabilitiesOutput"></a>
## type [CapabilitiesOutput](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L153-L157>)

CapabilitiesOutput represents the output of smartctl \-c \-j

```go
type CapabilitiesOutput struct {
    AtaSmartData               *AtaSmartData               `json:"ata_smart_data,omitempty"`
    NvmeControllerCapabilities *NvmeControllerCapabilities `json:"nvme_controller_capabilities,omitempty"`
    NvmeOptionalAdminCommands  *NvmeOptionalAdminCommands  `json:"nvme_optional_admin_commands,omitempty"`
}
```

<a name="Client"></a>
## type [Client](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L228-L231>)

Client represents a smartmontools client

```go
type Client struct {
    // contains filtered or unexported fields
}
```

<a name="Client.AbortSelfTest"></a>
### func \(\*Client\) [AbortSelfTest](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L639>)

```go
func (c *Client) AbortSelfTest(devicePath string) error
```

AbortSelfTest aborts a running self\-test on a device

<a name="Client.CheckHealth"></a>
### func \(\*Client\) [CheckHealth](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L333>)

```go
func (c *Client) CheckHealth(devicePath string) (bool, error)
```

CheckHealth checks if a device is healthy according to SMART

<a name="Client.DisableSMART"></a>
### func \(\*Client\) [DisableSMART](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L630>)

```go
func (c *Client) DisableSMART(devicePath string) error
```

DisableSMART disables SMART monitoring on a device

<a name="Client.EnableSMART"></a>
### func \(\*Client\) [EnableSMART](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L621>)

```go
func (c *Client) EnableSMART(devicePath string) error
```

EnableSMART enables SMART monitoring on a device

<a name="Client.GetAvailableSelfTests"></a>
### func \(\*Client\) [GetAvailableSelfTests](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L524>)

```go
func (c *Client) GetAvailableSelfTests(devicePath string) (*SelfTestInfo, error)
```

GetAvailableSelfTests returns the list of available self\-test types and their durations for a device

<a name="Client.GetDeviceInfo"></a>
### func \(\*Client\) [GetDeviceInfo](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L354>)

```go
func (c *Client) GetDeviceInfo(devicePath string) (map[string]interface{}, error)
```

GetDeviceInfo retrieves basic device information

<a name="Client.GetSMARTInfo"></a>
### func \(\*Client\) [GetSMARTInfo](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L294>)

```go
func (c *Client) GetSMARTInfo(devicePath string) (*SMARTInfo, error)
```

GetSMARTInfo retrieves SMART information for a device

<a name="Client.IsSMARTSupported"></a>
### func \(\*Client\) [IsSMARTSupported](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L583>)

```go
func (c *Client) IsSMARTSupported(devicePath string) (*SMARTSupportInfo, error)
```

IsSMARTSupported checks if SMART is supported on a device and if it's enabled

<a name="Client.RunSelfTest"></a>
### func \(\*Client\) [RunSelfTest](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L370>)

```go
func (c *Client) RunSelfTest(devicePath string, testType string) error
```

RunSelfTest initiates a SMART self\-test

<a name="Client.RunSelfTestWithProgress"></a>
### func \(\*Client\) [RunSelfTestWithProgress](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L395>)

```go
func (c *Client) RunSelfTestWithProgress(ctx context.Context, devicePath string, testType string, callback ProgressCallback) error
```

RunSelfTestWithProgress starts a SMART self\-test and reports progress

<a name="Client.ScanDevices"></a>
### func \(\*Client\) [ScanDevices](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L264>)

```go
func (c *Client) ScanDevices() ([]Device, error)
```

ScanDevices scans for available storage devices

<a name="Cmd"></a>
## type [Cmd](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L24-L27>)

Cmd interface for command execution

```go
type Cmd interface {
    Output() ([]byte, error)
    Run() error
}
```

<a name="Commander"></a>
## type [Commander](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L19-L21>)

Commander interface for executing commands

```go
type Commander interface {
    Command(name string, arg ...string) Cmd
}
```

<a name="Device"></a>
## type [Device](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L38-L41>)

Device represents a storage device

```go
type Device struct {
    Name string
    Type string
}
```

<a name="Flags"></a>
## type [Flags](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L172-L181>)

Flags represents attribute flags

```go
type Flags struct {
    Value         int    `json:"value"`
    String        string `json:"string"`
    PreFailure    bool   `json:"prefailure"`
    UpdatedOnline bool   `json:"updated_online"`
    Performance   bool   `json:"performance"`
    ErrorRate     bool   `json:"error_rate"`
    EventCount    bool   `json:"event_count"`
    AutoKeep      bool   `json:"auto_keep"`
}
```

<a name="Message"></a>
## type [Message](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L200-L203>)

Message represents a message from smartctl

```go
type Message struct {
    String   string `json:"string"`
    Severity string `json:"severity,omitempty"`
}
```

<a name="NvmeControllerCapabilities"></a>
## type [NvmeControllerCapabilities](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L44-L46>)

NvmeControllerCapabilities represents NVMe controller capabilities

```go
type NvmeControllerCapabilities struct {
    SelfTest bool `json:"self_test,omitempty"`
}
```

<a name="NvmeOptionalAdminCommands"></a>
## type [NvmeOptionalAdminCommands](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L148-L150>)

NvmeOptionalAdminCommands represents NVMe optional admin commands

```go
type NvmeOptionalAdminCommands struct {
    SelfTest bool `json:"self_test,omitempty"`
}
```

<a name="NvmeSmartHealth"></a>
## type [NvmeSmartHealth](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L49-L68>)

NvmeSmartHealth represents NVMe SMART health information

```go
type NvmeSmartHealth struct {
    CriticalWarning      int   `json:"critical_warning,omitempty"`
    Temperature          int   `json:"temperature,omitempty"`
    AvailableSpare       int   `json:"available_spare,omitempty"`
    AvailableSpareThresh int   `json:"available_spare_threshold,omitempty"`
    PercentageUsed       int   `json:"percentage_used,omitempty"`
    DataUnitsRead        int64 `json:"data_units_read,omitempty"`
    DataUnitsWritten     int64 `json:"data_units_written,omitempty"`
    HostReadCommands     int64 `json:"host_read_commands,omitempty"`
    HostWriteCommands    int64 `json:"host_write_commands,omitempty"`
    ControllerBusyTime   int64 `json:"controller_busy_time,omitempty"`
    PowerCycles          int64 `json:"power_cycles,omitempty"`
    PowerOnHours         int64 `json:"power_on_hours,omitempty"`
    UnsafeShutdowns      int64 `json:"unsafe_shutdowns,omitempty"`
    MediaErrors          int64 `json:"media_errors,omitempty"`
    NumErrLogEntries     int64 `json:"num_err_log_entries,omitempty"`
    WarningTempTime      int   `json:"warning_temp_time,omitempty"`
    CriticalCompTime     int   `json:"critical_comp_time,omitempty"`
    TemperatureSensors   []int `json:"temperature_sensors,omitempty"`
}
```

<a name="OfflineDataCollection"></a>
## type [OfflineDataCollection](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L115-L118>)

OfflineDataCollection represents offline data collection status

```go
type OfflineDataCollection struct {
    Status            string `json:"status,omitempty"`
    CompletionSeconds int    `json:"completion_seconds,omitempty"`
}
```

<a name="PollingMinutes"></a>
## type [PollingMinutes](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L121-L125>)

PollingMinutes represents polling minutes for different test types

```go
type PollingMinutes struct {
    Short      int `json:"short,omitempty"`
    Extended   int `json:"extended,omitempty"`
    Conveyance int `json:"conveyance,omitempty"`
}
```

<a name="PowerOnTime"></a>
## type [PowerOnTime](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L195-L197>)

PowerOnTime represents power on time

```go
type PowerOnTime struct {
    Hours int `json:"hours"`
}
```

<a name="ProgressCallback"></a>
## type [ProgressCallback](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L392>)

ProgressCallback is a function type for reporting progress

```go
type ProgressCallback func(progress int, status string)
```

<a name="Raw"></a>
## type [Raw](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L184-L187>)

Raw represents raw attribute value

```go
type Raw struct {
    Value  int64  `json:"value"`
    String string `json:"string"`
}
```

<a name="SMARTInfo"></a>
## type [SMARTInfo](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L71-L87>)

SMARTInfo represents SMART information for a device

```go
type SMARTInfo struct {
    Device                     Device                      `json:"device"`
    ModelFamily                string                      `json:"model_family,omitempty"`
    ModelName                  string                      `json:"model_name,omitempty"`
    SerialNumber               string                      `json:"serial_number,omitempty"`
    Firmware                   string                      `json:"firmware_version,omitempty"`
    UserCapacity               int64                       `json:"user_capacity,omitempty"`
    SmartStatus                SmartStatus                 `json:"smart_status,omitempty"`
    SmartSupport               *SmartSupport               `json:"smart_support,omitempty"`
    AtaSmartData               *AtaSmartData               `json:"ata_smart_data,omitempty"`
    NvmeSmartHealth            *NvmeSmartHealth            `json:"nvme_smart_health_information_log,omitempty"`
    NvmeControllerCapabilities *NvmeControllerCapabilities `json:"nvme_controller_capabilities,omitempty"`
    Temperature                *Temperature                `json:"temperature,omitempty"`
    PowerOnTime                *PowerOnTime                `json:"power_on_time,omitempty"`
    PowerCycleCount            int                         `json:"power_cycle_count,omitempty"`
    Smartctl                   *SmartctlInfo               `json:"smartctl,omitempty"`
}
```

<a name="SMARTSupportInfo"></a>
## type [SMARTSupportInfo](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L101-L104>)

SMARTSupportInfo represents SMART support and enablement information

```go
type SMARTSupportInfo struct {
    Supported bool
    Enabled   bool
}
```

<a name="SelfTest"></a>
## type [SelfTest](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L128-L131>)

SelfTest represents self\-test information

```go
type SelfTest struct {
    Status         string          `json:"status,omitempty"`
    PollingMinutes *PollingMinutes `json:"polling_minutes,omitempty"`
}
```

<a name="SelfTestInfo"></a>
## type [SelfTestInfo](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L142-L145>)

SelfTestInfo represents available self\-tests and their durations

```go
type SelfTestInfo struct {
    Available []string       `json:"available"`
    Durations map[string]int `json:"durations"`
}
```

<a name="SmartAttribute"></a>
## type [SmartAttribute](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L160-L169>)

SmartAttribute represents a single SMART attribute

```go
type SmartAttribute struct {
    ID         int    `json:"id"`
    Name       string `json:"name"`
    Value      int    `json:"value"`
    Worst      int    `json:"worst"`
    Thresh     int    `json:"thresh"`
    WhenFailed string `json:"when_failed,omitempty"`
    Flags      Flags  `json:"flags"`
    Raw        Raw    `json:"raw"`
}
```

<a name="SmartClient"></a>
## type [SmartClient](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L213-L225>)

SmartClient interface defines the methods for interacting with smartmontools

```go
type SmartClient interface {
    ScanDevices() ([]Device, error)
    GetSMARTInfo(devicePath string) (*SMARTInfo, error)
    CheckHealth(devicePath string) (bool, error)
    GetDeviceInfo(devicePath string) (map[string]interface{}, error)
    RunSelfTest(devicePath string, testType string) error
    RunSelfTestWithProgress(ctx context.Context, devicePath string, testType string, callback ProgressCallback) error
    GetAvailableSelfTests(devicePath string) (*SelfTestInfo, error)
    IsSMARTSupported(devicePath string) (*SMARTSupportInfo, error)
    EnableSMART(devicePath string) error
    DisableSMART(devicePath string) error
    AbortSelfTest(devicePath string) error
}
```

<a name="NewClient"></a>
### func [NewClient](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L234>)

```go
func NewClient() (SmartClient, error)
```

NewClient creates a new smartmontools client

<a name="NewClientWithCommander"></a>
### func [NewClientWithCommander](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L256>)

```go
func NewClientWithCommander(smartctlPath string, commander Commander) SmartClient
```

NewClientWithCommander creates a new client with a custom commander \(for testing\)

<a name="NewClientWithPath"></a>
### func [NewClientWithPath](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L248>)

```go
func NewClientWithPath(smartctlPath string) SmartClient
```

NewClientWithPath creates a new smartmontools client with a specific smartctl path

<a name="SmartStatus"></a>
## type [SmartStatus](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L90-L92>)

SmartStatus represents the overall SMART health status

```go
type SmartStatus struct {
    Passed bool `json:"passed"`
}
```

<a name="SmartSupport"></a>
## type [SmartSupport](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L95-L98>)

SmartSupport represents SMART availability and enablement status

```go
type SmartSupport struct {
    Available bool `json:"available"`
    Enabled   bool `json:"enabled"`
}
```

<a name="SmartctlInfo"></a>
## type [SmartctlInfo](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L206-L210>)

SmartctlInfo represents smartctl metadata and messages

```go
type SmartctlInfo struct {
    Version    []int     `json:"version,omitempty"`
    Messages   []Message `json:"messages,omitempty"`
    ExitStatus int       `json:"exit_status,omitempty"`
}
```

<a name="Temperature"></a>
## type [Temperature](<https://github.com/dianlight/smartmontools-go/blob/main/smartmontools.go#L190-L192>)

Temperature represents device temperature

```go
type Temperature struct {
    Current int `json:"current"`
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
